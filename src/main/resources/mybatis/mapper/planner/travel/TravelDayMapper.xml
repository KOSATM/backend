<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.planner.travel.dao.TravelDayDao">

  <select id="selectTravelDayById" parameterType="long" resultType="com.example.demo.planner.travel.dto.entity.TravelDay">
    SELECT id, travel_plan_id, day_index, title, plan_date
    FROM plan_days
    WHERE id = #{id}
  </select>

  <select id="selectTravelDaysByPlanId" parameterType="long" resultType="com.example.demo.planner.travel.dto.entity.TravelDay">
    SELECT id, travel_plan_id, day_index, title, plan_date
    FROM plan_days
    WHERE travel_plan_id = #{travelPlanId}
    ORDER BY day_index ASC
  </select>

  <insert id="insertTravelDay" parameterType="com.example.demo.planner.travel.dto.entity.TravelDay" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
    INSERT INTO plan_days (travel_plan_id, day_index, title, plan_date)
    VALUES (#{travelPlanId}, #{dayIndex}, #{title}, #{planDate})
  </insert>

  <update id="updateTravelDay" parameterType="com.example.demo.planner.travel.dto.entity.TravelDay">
    UPDATE plan_days
    SET travel_plan_id = #{travelPlanId},
        day_index = #{dayIndex},
        title = #{title},
        plan_date = #{planDate}
    WHERE id = #{id}
  </update>

  <delete id="deleteTravelDay" parameterType="long">
    DELETE FROM plan_days
    WHERE id = #{id}
  </delete>

  <delete id="deleteTravelDaysByPlanId" parameterType="long">
    DELETE FROM plan_days
    WHERE travel_plan_id = #{travelPlanId}
  </delete>

</mapper>
